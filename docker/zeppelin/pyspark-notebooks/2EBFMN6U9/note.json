{
  "paragraphs": [
    {
      "text": "// %dep\n\n// z.load(\"JohnSnowLabs:spark-nlp:2.0.1\")",
      "user": "anonymous",
      "dateUpdated": "2019-04-24 12:57:06.940",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "res0: org.apache.zeppelin.dep.Dependency \u003d org.apache.zeppelin.dep.Dependency@77ffa773\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1556040657283_-1330756823",
      "id": "20190423-173057_1819333331",
      "dateCreated": "2019-04-23 17:30:57.284",
      "dateStarted": "2019-04-24 09:45:38.538",
      "dateFinished": "2019-04-24 09:45:55.095",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%sh\npip install spark-nlp\npython -m spacy download en_core_web_sm",
      "user": "anonymous",
      "dateUpdated": "2019-04-24 10:10:09.935",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "sh",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "editorMode": "ace/mode/sh"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "Requirement already satisfied (use --upgrade to upgrade): spark-nlp in /opt/conda/lib/python2.7/site-packages\nYou are using pip version 8.1.2, however version 19.0.3 is available.\nYou should consider upgrading via the \u0027pip install --upgrade pip\u0027 command.\nRequirement already satisfied (use --upgrade to upgrade): en_core_web_sm\u003d\u003d2.1.0 from https://github.com/explosion/spacy-models/releases/download/en_core_web_sm-2.1.0/en_core_web_sm-2.1.0.tar.gz#egg\u003den_core_web_sm\u003d\u003d2.1.0 in /opt/conda/lib/python2.7/site-packages\nYou are using pip version 8.1.2, however version 19.0.3 is available.\nYou should consider upgrading via the \u0027pip install --upgrade pip\u0027 command.\n\u001b[38;5;2m[+] Download and installation successful\u001b[0m\nYou can now load the model via spacy.load(\u0027en_core_web_sm\u0027)\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1556044125611_1266883969",
      "id": "20190423-182845_473888658",
      "dateCreated": "2019-04-23 18:28:45.611",
      "dateStarted": "2019-04-24 10:10:10.003",
      "dateFinished": "2019-04-24 10:10:12.273",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%sh\npip install spacy",
      "user": "anonymous",
      "dateUpdated": "2019-04-24 10:03:19.444",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "sh",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "editorMode": "ace/mode/sh"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "Requirement already satisfied (use --upgrade to upgrade): spacy in /opt/conda/lib/python2.7/site-packages\nRequirement already satisfied (use --upgrade to upgrade): pathlib\u003d\u003d1.0.1; python_version \u003c \"3.4\" in /opt/conda/lib/python2.7/site-packages (from spacy)\nRequirement already satisfied (use --upgrade to upgrade): wasabi\u003c1.1.0,\u003e\u003d0.2.0 in /opt/conda/lib/python2.7/site-packages (from spacy)\nRequirement already satisfied (use --upgrade to upgrade): blis\u003c0.3.0,\u003e\u003d0.2.2 in /opt/conda/lib/python2.7/site-packages (from spacy)\nRequirement already satisfied (use --upgrade to upgrade): plac\u003c1.0.0,\u003e\u003d0.9.6 in /opt/conda/lib/python2.7/site-packages (from spacy)\nRequirement already satisfied (use --upgrade to upgrade): murmurhash\u003c1.1.0,\u003e\u003d0.28.0 in /opt/conda/lib/python2.7/site-packages (from spacy)\nRequirement already satisfied (use --upgrade to upgrade): requests\u003c3.0.0,\u003e\u003d2.13.0 in /opt/conda/lib/python2.7/site-packages (from spacy)\nRequirement already satisfied (use --upgrade to upgrade): numpy\u003e\u003d1.15.0 in /opt/conda/lib/python2.7/site-packages (from spacy)\nRequirement already satisfied (use --upgrade to upgrade): srsly\u003c1.1.0,\u003e\u003d0.0.5 in /opt/conda/lib/python2.7/site-packages (from spacy)\nRequirement already satisfied (use --upgrade to upgrade): cymem\u003c2.1.0,\u003e\u003d2.0.2 in /opt/conda/lib/python2.7/site-packages (from spacy)\nRequirement already satisfied (use --upgrade to upgrade): preshed\u003c2.1.0,\u003e\u003d2.0.1 in /opt/conda/lib/python2.7/site-packages (from spacy)\nRequirement already satisfied (use --upgrade to upgrade): jsonschema\u003c3.0.0,\u003e\u003d2.6.0 in /opt/conda/lib/python2.7/site-packages (from spacy)\nRequirement already satisfied (use --upgrade to upgrade): thinc\u003c7.1.0,\u003e\u003d7.0.2 in /opt/conda/lib/python2.7/site-packages (from spacy)\nRequirement already satisfied (use --upgrade to upgrade): functools32; python_version \u003d\u003d \"2.7\" in /opt/conda/lib/python2.7/site-packages (from jsonschema\u003c3.0.0,\u003e\u003d2.6.0-\u003espacy)\nRequirement already satisfied (use --upgrade to upgrade): tqdm\u003c5.0.0,\u003e\u003d4.10.0 in /opt/conda/lib/python2.7/site-packages (from thinc\u003c7.1.0,\u003e\u003d7.0.2-\u003espacy)\nYou are using pip version 8.1.2, however version 19.0.3 is available.\nYou should consider upgrading via the \u0027pip install --upgrade pip\u0027 command.\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1556099212438_399560176",
      "id": "20190424-094652_336305029",
      "dateCreated": "2019-04-24 09:46:52.438",
      "dateStarted": "2019-04-24 10:03:19.752",
      "dateFinished": "2019-04-24 10:03:23.862",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%pyspark\n\ndf \u003d (spark.read.format(\"com.databricks.spark.csv\")\n        .option(\"quoteMode\",\"ALL\")\n        .option(\"multiLine\",\"true\")\n        .option(\"wholeFile\",\"true\")\n        .option(\"header\", \"true\")\n        .option(\"inferSchema\",\"true\")\n        .load(\"/machinelearning/reddit_200k.csv\")).limit(20000)\n        \ndf.cache()\ndf.show()",
      "user": "anonymous",
      "dateUpdated": "2019-04-24 15:46:54.100",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+--------+--------------------+-----+---------+-------+------------+--------------+-------+\n|prev_idx|                body|score|parent_id|     id|created_date|retrieved_date|removed|\n+--------+--------------------+-----+---------+-------+------------+--------------+-------+\n|       1|I\u0027ve always been ...|    2|t3_81u15i|dv551g6|  1520121101|    1524782256|  False|\n|       2|\"As an ECE, my fi...|    2|t3_72sk35|dnl66g6|  1506533157|    1507150439|   True|\n|       3|Monday: Drug comp...|    5|t3_8o88yr|e02sjhz|  1528087570|    1532170350|   True|\n|       4|i learned that al...|    0|t3_6xg9t8|dmfojjp|  1504290041|    1506407514|  False|\n|       5|Well i was wantin...|    3|t3_99wi9m|e4rtew8|  1535140675|    1537893540|  False|\n|       6|So when we can re...|    4|t3_69fya9|dh6bkbf|  1494006743|    1496285592|  False|\n|       7|Keep going! So cl...|  110|t3_926dfb|e33l7ug|  1532647663|    1536705787|   True|\n|       8|Rains here just s...|    2|t3_9dzqzm|e5lmvpe|  1536388817|    1538826252|   True|\n|       9|That explains it,...|    5|t3_81yesj|dv63j9z|  1520179348|    1524803905|   True|\n|      10|Hi BocceBaller42,...|    2|t3_5r1nu1|dd3pv7z|  1485793932|    1486560607|  False|\n|      11|Kinda what happen...|    8|t3_897pfk|dwq79ih|  1522760848|    1525907694|  False|\n|      12|This sounds like ...|   -6|t3_92lntd|e36lekj|  1532781451|    1536789657|   True|\n|      13|If nothing comes ...|    2|t3_7h4fo1|dqo8bzn|  1512250097|    1514278382|  False|\n|      14|If medicine keeps...|    3|t3_6a1n9a|dhcmyqr|  1494371185|    1496395068|  False|\n|      15|do you think the ...|   38|t3_6cmkb4|dhvrjpu|  1495453015|    1496726838|  False|\n|      16|I don\u0027t understan...|   12|t3_63kuuw|dfuzqkt|  1491398216|    1493815055|  False|\n|      17|I dislike the ton...|    2|t3_68cz07|dgy714f|  1493569268|    1494504338|   True|\n|      18|I look forward to...|    2|t3_95391g|e3pvpie|  1533583605|    1537146813|  False|\n|      19|My visible tattoo...|    2|t3_966h9i|e3y8tfx|  1533911117|    1537326805|  False|\n|      20|3 weeks?  Why onl...|   14|t3_90f0in|e2q1bny|  1532093248|    1536306515|   True|\n+--------+--------------------+-----+---------+-------+------------+--------------+-------+\nonly showing top 20 rows\n\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1556038381328_-835348963",
      "id": "20190423-165301_2107108866",
      "dateCreated": "2019-04-23 16:53:01.328",
      "dateStarted": "2019-04-24 15:46:54.155",
      "dateFinished": "2019-04-24 15:47:33.255",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%pyspark\n\nfrom pyspark.sql.types import IntegerType\nfrom pyspark.sql.functions import udf, col\n\nlabel_udf \u003d udf(lambda x: 1 if x \u003d\u003d \"True\" else 0, IntegerType())\n\ndf_input \u003d df.withColumn(\n    \"label\",\n    label_udf(col(\"removed\")))\n\ndf_input.cache()\ndf_input.show()",
      "user": "anonymous",
      "dateUpdated": "2019-04-24 15:48:02.908",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+--------+--------------------+-----+---------+-------+------------+--------------+-------+-----+\n|prev_idx|                body|score|parent_id|     id|created_date|retrieved_date|removed|label|\n+--------+--------------------+-----+---------+-------+------------+--------------+-------+-----+\n|       1|I\u0027ve always been ...|    2|t3_81u15i|dv551g6|  1520121101|    1524782256|  False|    0|\n|       2|\"As an ECE, my fi...|    2|t3_72sk35|dnl66g6|  1506533157|    1507150439|   True|    1|\n|       3|Monday: Drug comp...|    5|t3_8o88yr|e02sjhz|  1528087570|    1532170350|   True|    1|\n|       4|i learned that al...|    0|t3_6xg9t8|dmfojjp|  1504290041|    1506407514|  False|    0|\n|       5|Well i was wantin...|    3|t3_99wi9m|e4rtew8|  1535140675|    1537893540|  False|    0|\n|       6|So when we can re...|    4|t3_69fya9|dh6bkbf|  1494006743|    1496285592|  False|    0|\n|       7|Keep going! So cl...|  110|t3_926dfb|e33l7ug|  1532647663|    1536705787|   True|    1|\n|       8|Rains here just s...|    2|t3_9dzqzm|e5lmvpe|  1536388817|    1538826252|   True|    1|\n|       9|That explains it,...|    5|t3_81yesj|dv63j9z|  1520179348|    1524803905|   True|    1|\n|      10|Hi BocceBaller42,...|    2|t3_5r1nu1|dd3pv7z|  1485793932|    1486560607|  False|    0|\n|      11|Kinda what happen...|    8|t3_897pfk|dwq79ih|  1522760848|    1525907694|  False|    0|\n|      12|This sounds like ...|   -6|t3_92lntd|e36lekj|  1532781451|    1536789657|   True|    1|\n|      13|If nothing comes ...|    2|t3_7h4fo1|dqo8bzn|  1512250097|    1514278382|  False|    0|\n|      14|If medicine keeps...|    3|t3_6a1n9a|dhcmyqr|  1494371185|    1496395068|  False|    0|\n|      15|do you think the ...|   38|t3_6cmkb4|dhvrjpu|  1495453015|    1496726838|  False|    0|\n|      16|I don\u0027t understan...|   12|t3_63kuuw|dfuzqkt|  1491398216|    1493815055|  False|    0|\n|      17|I dislike the ton...|    2|t3_68cz07|dgy714f|  1493569268|    1494504338|   True|    1|\n|      18|I look forward to...|    2|t3_95391g|e3pvpie|  1533583605|    1537146813|  False|    0|\n|      19|My visible tattoo...|    2|t3_966h9i|e3y8tfx|  1533911117|    1537326805|  False|    0|\n|      20|3 weeks?  Why onl...|   14|t3_90f0in|e2q1bny|  1532093248|    1536306515|   True|    1|\n+--------+--------------------+-----+---------+-------+------------+--------------+-------+-----+\nonly showing top 20 rows\n\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1556116634821_-1256431770",
      "id": "20190424-143714_1757490237",
      "dateCreated": "2019-04-24 14:37:14.821",
      "dateStarted": "2019-04-24 15:48:02.955",
      "dateFinished": "2019-04-24 15:48:05.311",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%pyspark\n\nfrom pyspark import keyword_only \nfrom pyspark.ml import Transformer\nfrom pyspark.ml.param.shared import HasInputCol, HasOutputCol, Param\nfrom pyspark.sql.functions import udf, col\nfrom pyspark.sql.types import ArrayType, StringType\nfrom pyspark.ml.wrapper import JavaParams\nfrom pyspark.ml.feature import Tokenizer\n\nimport spacy\n\nclass SpacyMagic(object):\n    \"\"\"\n    Simple Spacy Magic to minimize loading time.\n    \u003e\u003e\u003e SpacyMagic.get(\"en\")\n    \u003cspacy.lang.en.English ...\n    \"\"\"\n    _spacys \u003d {}\n    _symbols \u003d set(\"!$%^\u0026*()_+|~-\u003d`{}[]:\\\";\u0027\u003c\u003e?,./-\")\n\n    @classmethod\n    def get(cls, lang):\n        if lang not in cls._spacys:\n            import spacy\n            cls._spacys[lang] \u003d spacy.load(lang, disable\u003d[\u0027parser\u0027, \u0027tagger\u0027, \u0027ner\u0027])\n        return cls._spacys[lang]\n\n    @staticmethod\n    def tokenize(text):\n        nlp \u003d SpacyMagic.get(\"en\")\n        doc \u003d nlp(text, disable\u003d[\u0027parser\u0027, \u0027tagger\u0027, \u0027ner\u0027])\n        tokens \u003d []\n        for token in doc:\n            if token.like_url:\n                clean_token \u003d \"URL\"\n            else:\n                clean_token \u003d token.lemma_.lower().strip()\n                if len(clean_token) \u003c 1 or clean_token in \\\n                        SpacyMagic._symbols: \n                    continue\n            tokens.append(clean_token)\n        return tokens\n\n\nclass SpacyTokenizer(Tokenizer):\n\n    def transform(self, dataset):\n        \n        tokenize_udf \u003d udf(lambda x: SpacyMagic.tokenize(x), \n                                ArrayType(StringType()))\n\n        out_col \u003d self.getOutputCol()\n        in_col \u003d self.getInputCol()\n\n        dataset_tokenized \u003d dataset.withColumn(\n            out_col,\n            tokenize_udf(col(in_col)))\n        \n        return dataset_tokenized\n    ",
      "user": "anonymous",
      "dateUpdated": "2019-04-24 15:48:10.229",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "jobName": "paragraph_1556114731533_-803425142",
      "id": "20190424-140531_246570498",
      "dateCreated": "2019-04-24 14:05:31.533",
      "dateStarted": "2019-04-24 15:48:10.279",
      "dateFinished": "2019-04-24 15:48:11.232",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%pyspark\ntokenizer \u003d SpacyTokenizer(inputCol\u003d\"body\", outputCol\u003d\"body_tokenized\")\ndf_tokenized \u003d tokenizer.transform(df_input)\ndf_tokenized.show()",
      "user": "anonymous",
      "dateUpdated": "2019-04-24 15:24:06.751",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+--------+--------------------+-----+---------+-------+------------+--------------+-------+-----+--------------------+\n|prev_idx|                body|score|parent_id|     id|created_date|retrieved_date|removed|label|      body_tokenized|\n+--------+--------------------+-----+---------+-------+------------+--------------+-------+-----+--------------------+\n|       1|I\u0027ve always been ...|    2|t3_81u15i|dv551g6|  1520121101|    1524782256|  False|    0|[-pron-, have, al...|\n|       2|\"As an ECE, my fi...|    2|t3_72sk35|dnl66g6|  1506533157|    1507150439|   True|    1|[as, a, ece, my, ...|\n|       3|Monday: Drug comp...|    5|t3_8o88yr|e02sjhz|  1528087570|    1532170350|   True|    1|[monday, drug, co...|\n|       4|i learned that al...|    0|t3_6xg9t8|dmfojjp|  1504290041|    1506407514|  False|    0|[i, learn, that, ...|\n|       5|Well i was wantin...|    3|t3_99wi9m|e4rtew8|  1535140675|    1537893540|  False|    0|[well, i, be, wan...|\n|       6|So when we can re...|    4|t3_69fya9|dh6bkbf|  1494006743|    1496285592|  False|    0|[so, when, we, ca...|\n|       7|Keep going! So cl...|  110|t3_926dfb|e33l7ug|  1532647663|    1536705787|   True|    1|[keep, go, so, cl...|\n|       8|Rains here just s...|    2|t3_9dzqzm|e5lmvpe|  1536388817|    1538826252|   True|    1|[rains, here, jus...|\n|       9|That explains it,...|    5|t3_81yesj|dv63j9z|  1520179348|    1524803905|   True|    1|[that, explain, i...|\n|      10|Hi BocceBaller42,...|    2|t3_5r1nu1|dd3pv7z|  1485793932|    1486560607|  False|    0|[hi, bocceballer4...|\n|      11|Kinda what happen...|    8|t3_897pfk|dwq79ih|  1522760848|    1525907694|  False|    0|[kinda, what, hap...|\n|      12|This sounds like ...|   -6|t3_92lntd|e36lekj|  1532781451|    1536789657|   True|    1|[this, sound, lik...|\n|      13|If nothing comes ...|    2|t3_7h4fo1|dqo8bzn|  1512250097|    1514278382|  False|    0|[if, nothing, com...|\n|      14|If medicine keeps...|    3|t3_6a1n9a|dhcmyqr|  1494371185|    1496395068|  False|    0|[if, medicine, ke...|\n|      15|do you think the ...|   38|t3_6cmkb4|dhvrjpu|  1495453015|    1496726838|  False|    0|[do, you, think, ...|\n|      16|I don\u0027t understan...|   12|t3_63kuuw|dfuzqkt|  1491398216|    1493815055|  False|    0|[i, do, not, unde...|\n|      17|I dislike the ton...|    2|t3_68cz07|dgy714f|  1493569268|    1494504338|   True|    1|[i, dislike, the,...|\n|      18|I look forward to...|    2|t3_95391g|e3pvpie|  1533583605|    1537146813|  False|    0|[i, look, forward...|\n|      19|My visible tattoo...|    2|t3_966h9i|e3y8tfx|  1533911117|    1537326805|  False|    0|[my, visible, tat...|\n|      20|3 weeks?  Why onl...|   14|t3_90f0in|e2q1bny|  1532093248|    1536306515|   True|    1|[3, week, why, on...|\n+--------+--------------------+-----+---------+-------+------------+--------------+-------+-----+--------------------+\nonly showing top 20 rows\n\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1556115403161_2089011894",
      "id": "20190424-141643_1633520699",
      "dateCreated": "2019-04-24 14:16:43.161",
      "dateStarted": "2019-04-24 15:24:06.798",
      "dateFinished": "2019-04-24 15:24:09.543",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%pyspark\nfrom pyspark.ml.feature import NGram\n\nngram \u003d NGram(inputCol\u003d\u0027body_tokenized\u0027, outputCol\u003d\u0027body_ngram\u0027, n\u003d3)\ndf_ngram \u003d ngram.transform(df_tokenized)\n\ndf_ngram.cache()\ndf_ngram.show()\nprint(\"DONE caching\")\n\n# df_tokenized.unpersist()\n# print(\"FINISHED\")",
      "user": "anonymous",
      "dateUpdated": "2019-04-24 14:39:03.462",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+--------+--------------------+-----+---------+-------+------------+--------------+-------+-----+--------------------+--------------------+\n|prev_idx|                body|score|parent_id|     id|created_date|retrieved_date|removed|label|      body_tokenized|          body_ngram|\n+--------+--------------------+-----+---------+-------+------------+--------------+-------+-----+--------------------+--------------------+\n|       1|I\u0027ve always been ...|    2|t3_81u15i|dv551g6|  1520121101|    1524782256|  False|    0|[-pron-, have, al...|[-pron- have alwa...|\n|       2|\"As an ECE, my fi...|    2|t3_72sk35|dnl66g6|  1506533157|    1507150439|   True|    1|[as, a, ece, my, ...|[as a ece, a ece ...|\n|       3|Monday: Drug comp...|    5|t3_8o88yr|e02sjhz|  1528087570|    1532170350|   True|    1|[monday, drug, co...|[monday drug comp...|\n|       4|i learned that al...|    0|t3_6xg9t8|dmfojjp|  1504290041|    1506407514|  False|    0|[i, learn, that, ...|[i learn that, le...|\n|       5|Well i was wantin...|    3|t3_99wi9m|e4rtew8|  1535140675|    1537893540|  False|    0|[well, i, be, wan...|[well i be, i be ...|\n|       6|So when we can re...|    4|t3_69fya9|dh6bkbf|  1494006743|    1496285592|  False|    0|[so, when, we, ca...|[so when we, when...|\n|       7|Keep going! So cl...|  110|t3_926dfb|e33l7ug|  1532647663|    1536705787|   True|    1|[keep, go, so, cl...|[keep go so, go s...|\n|       8|Rains here just s...|    2|t3_9dzqzm|e5lmvpe|  1536388817|    1538826252|   True|    1|[rains, here, jus...|[rains here just,...|\n|       9|That explains it,...|    5|t3_81yesj|dv63j9z|  1520179348|    1524803905|   True|    1|[that, explain, i...|[that explain it,...|\n|      10|Hi BocceBaller42,...|    2|t3_5r1nu1|dd3pv7z|  1485793932|    1486560607|  False|    0|[hi, bocceballer4...|[hi bocceballer42...|\n|      11|Kinda what happen...|    8|t3_897pfk|dwq79ih|  1522760848|    1525907694|  False|    0|[kinda, what, hap...|[kinda what happe...|\n|      12|This sounds like ...|   -6|t3_92lntd|e36lekj|  1532781451|    1536789657|   True|    1|[this, sound, lik...|[this sound like,...|\n|      13|If nothing comes ...|    2|t3_7h4fo1|dqo8bzn|  1512250097|    1514278382|  False|    0|[if, nothing, com...|[if nothing come,...|\n|      14|If medicine keeps...|    3|t3_6a1n9a|dhcmyqr|  1494371185|    1496395068|  False|    0|[if, medicine, ke...|[if medicine keep...|\n|      15|do you think the ...|   38|t3_6cmkb4|dhvrjpu|  1495453015|    1496726838|  False|    0|[do, you, think, ...|[do you think, yo...|\n|      16|I don\u0027t understan...|   12|t3_63kuuw|dfuzqkt|  1491398216|    1493815055|  False|    0|[i, do, not, unde...|[i do not, do not...|\n|      17|I dislike the ton...|    2|t3_68cz07|dgy714f|  1493569268|    1494504338|   True|    1|[i, dislike, the,...|[i dislike the, d...|\n|      18|I look forward to...|    2|t3_95391g|e3pvpie|  1533583605|    1537146813|  False|    0|[i, look, forward...|[i look forward, ...|\n|      19|My visible tattoo...|    2|t3_966h9i|e3y8tfx|  1533911117|    1537326805|  False|    0|[my, visible, tat...|[my visible tatto...|\n|      20|3 weeks?  Why onl...|   14|t3_90f0in|e2q1bny|  1532093248|    1536306515|   True|    1|[3, week, why, on...|[3 week why, week...|\n+--------+--------------------+-----+---------+-------+------------+--------------+-------+-----+--------------------+--------------------+\nonly showing top 20 rows\n\nDONE caching\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1556104574063_-2031193949",
      "id": "20190424-111614_1710459625",
      "dateCreated": "2019-04-24 11:16:14.063",
      "dateStarted": "2019-04-24 14:39:03.504",
      "dateFinished": "2019-04-24 14:39:22.888",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%pyspark\nfrom pyspark.ml.feature import CountVectorizer\n\ncv \u003d CountVectorizer(inputCol\u003d\u0027body_ngram\u0027, outputCol\u003d\u0027body_tf\u0027)\ncv_model \u003d cv.fit(df_ngram)\ndf_tf \u003d cv_model.transform(df_ngram)\n\ndf_tf.cache()\ndf_tf.show()",
      "user": "anonymous",
      "dateUpdated": "2019-04-24 14:39:42.388",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+--------+--------------------+-----+---------+-------+------------+--------------+-------+-----+--------------------+--------------------+--------------------+\n|prev_idx|                body|score|parent_id|     id|created_date|retrieved_date|removed|label|      body_tokenized|          body_ngram|             body_tf|\n+--------+--------------------+-----+---------+-------+------------+--------------+-------+-----+--------------------+--------------------+--------------------+\n|       1|I\u0027ve always been ...|    2|t3_81u15i|dv551g6|  1520121101|    1524782256|  False|    0|[-pron-, have, al...|[-pron- have alwa...|(262144,[154,490,...|\n|       2|\"As an ECE, my fi...|    2|t3_72sk35|dnl66g6|  1506533157|    1507150439|   True|    1|[as, a, ece, my, ...|[as a ece, a ece ...|(262144,[90,151,3...|\n|       3|Monday: Drug comp...|    5|t3_8o88yr|e02sjhz|  1528087570|    1532170350|   True|    1|[monday, drug, co...|[monday drug comp...|(262144,[18022,44...|\n|       4|i learned that al...|    0|t3_6xg9t8|dmfojjp|  1504290041|    1506407514|  False|    0|[i, learn, that, ...|[i learn that, le...|(262144,[641,3511...|\n|       5|Well i was wantin...|    3|t3_99wi9m|e4rtew8|  1535140675|    1537893540|  False|    0|[well, i, be, wan...|[well i be, i be ...|(262144,[1374,192...|\n|       6|So when we can re...|    4|t3_69fya9|dh6bkbf|  1494006743|    1496285592|  False|    0|[so, when, we, ca...|[so when we, when...|(262144,[940,7987...|\n|       7|Keep going! So cl...|  110|t3_926dfb|e33l7ug|  1532647663|    1536705787|   True|    1|[keep, go, so, cl...|[keep go so, go s...|(262144,[2036,124...|\n|       8|Rains here just s...|    2|t3_9dzqzm|e5lmvpe|  1536388817|    1538826252|   True|    1|[rains, here, jus...|[rains here just,...|(262144,[1351,416...|\n|       9|That explains it,...|    5|t3_81yesj|dv63j9z|  1520179348|    1524803905|   True|    1|[that, explain, i...|[that explain it,...|(262144,[311,769,...|\n|      10|Hi BocceBaller42,...|    2|t3_5r1nu1|dd3pv7z|  1485793932|    1486560607|  False|    0|[hi, bocceballer4...|[hi bocceballer42...|(262144,[25,41,44...|\n|      11|Kinda what happen...|    8|t3_897pfk|dwq79ih|  1522760848|    1525907694|  False|    0|[kinda, what, hap...|[kinda what happe...|(262144,[0,6,11,2...|\n|      12|This sounds like ...|   -6|t3_92lntd|e36lekj|  1532781451|    1536789657|   True|    1|[this, sound, lik...|[this sound like,...|(262144,[514,852,...|\n|      13|If nothing comes ...|    2|t3_7h4fo1|dqo8bzn|  1512250097|    1514278382|  False|    0|[if, nothing, com...|[if nothing come,...|(262144,[23661,43...|\n|      14|If medicine keeps...|    3|t3_6a1n9a|dhcmyqr|  1494371185|    1496395068|  False|    0|[if, medicine, ke...|[if medicine keep...|(262144,[34,402,6...|\n|      15|do you think the ...|   38|t3_6cmkb4|dhvrjpu|  1495453015|    1496726838|  False|    0|[do, you, think, ...|[do you think, yo...|(262144,[24,47,11...|\n|      16|I don\u0027t understan...|   12|t3_63kuuw|dfuzqkt|  1491398216|    1493815055|  False|    0|[i, do, not, unde...|[i do not, do not...|(262144,[0,285,19...|\n|      17|I dislike the ton...|    2|t3_68cz07|dgy714f|  1493569268|    1494504338|   True|    1|[i, dislike, the,...|[i dislike the, d...|(262144,[967,1000...|\n|      18|I look forward to...|    2|t3_95391g|e3pvpie|  1533583605|    1537146813|  False|    0|[i, look, forward...|[i look forward, ...|(262144,[100,320,...|\n|      19|My visible tattoo...|    2|t3_966h9i|e3y8tfx|  1533911117|    1537326805|  False|    0|[my, visible, tat...|[my visible tatto...|(262144,[15,149,1...|\n|      20|3 weeks?  Why onl...|   14|t3_90f0in|e2q1bny|  1532093248|    1536306515|   True|    1|[3, week, why, on...|[3 week why, week...|(262144,[67786,11...|\n+--------+--------------------+-----+---------+-------+------------+--------------+-------+-----+--------------------+--------------------+--------------------+\nonly showing top 20 rows\n\nDONE caching\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1556107815631_210268408",
      "id": "20190424-121015_82852057",
      "dateCreated": "2019-04-24 12:10:15.631",
      "dateStarted": "2019-04-24 14:39:26.922",
      "dateFinished": "2019-04-24 14:39:35.253",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%pyspark\nfrom pyspark.ml.feature import IDF\n\nidf \u003d IDF(inputCol\u003d\u0027body_tf\u0027, outputCol\u003d\u0027body_tfidf\u0027)\nidf_model \u003d idf.fit(df_tf)\ndf_tfidf \u003d idf_model.transform(df_tf)\n\ndf_tfidf.cache()\ndf_tfidf.show()",
      "user": "anonymous",
      "dateUpdated": "2019-04-24 15:51:36.410",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+--------+--------------------+-----+---------+-------+------------+--------------+-------+-----+--------------------+--------------------+--------------------+--------------------+\n|prev_idx|                body|score|parent_id|     id|created_date|retrieved_date|removed|label|      body_tokenized|          body_ngram|             body_tf|          body_tfidf|\n+--------+--------------------+-----+---------+-------+------------+--------------+-------+-----+--------------------+--------------------+--------------------+--------------------+\n|       1|I\u0027ve always been ...|    2|t3_81u15i|dv551g6|  1520121101|    1524782256|  False|    0|[-pron-, have, al...|[-pron- have alwa...|(262144,[154,490,...|(262144,[154,490,...|\n|       2|\"As an ECE, my fi...|    2|t3_72sk35|dnl66g6|  1506533157|    1507150439|   True|    1|[as, a, ece, my, ...|[as a ece, a ece ...|(262144,[90,151,3...|(262144,[90,151,3...|\n|       3|Monday: Drug comp...|    5|t3_8o88yr|e02sjhz|  1528087570|    1532170350|   True|    1|[monday, drug, co...|[monday drug comp...|(262144,[18022,44...|(262144,[18022,44...|\n|       4|i learned that al...|    0|t3_6xg9t8|dmfojjp|  1504290041|    1506407514|  False|    0|[i, learn, that, ...|[i learn that, le...|(262144,[641,3511...|(262144,[641,3511...|\n|       5|Well i was wantin...|    3|t3_99wi9m|e4rtew8|  1535140675|    1537893540|  False|    0|[well, i, be, wan...|[well i be, i be ...|(262144,[1374,192...|(262144,[1374,192...|\n|       6|So when we can re...|    4|t3_69fya9|dh6bkbf|  1494006743|    1496285592|  False|    0|[so, when, we, ca...|[so when we, when...|(262144,[940,7987...|(262144,[940,7987...|\n|       7|Keep going! So cl...|  110|t3_926dfb|e33l7ug|  1532647663|    1536705787|   True|    1|[keep, go, so, cl...|[keep go so, go s...|(262144,[2036,124...|(262144,[2036,124...|\n|       8|Rains here just s...|    2|t3_9dzqzm|e5lmvpe|  1536388817|    1538826252|   True|    1|[rains, here, jus...|[rains here just,...|(262144,[1351,416...|(262144,[1351,416...|\n|       9|That explains it,...|    5|t3_81yesj|dv63j9z|  1520179348|    1524803905|   True|    1|[that, explain, i...|[that explain it,...|(262144,[311,769,...|(262144,[311,769,...|\n|      10|Hi BocceBaller42,...|    2|t3_5r1nu1|dd3pv7z|  1485793932|    1486560607|  False|    0|[hi, bocceballer4...|[hi bocceballer42...|(262144,[25,41,44...|(262144,[25,41,44...|\n|      11|Kinda what happen...|    8|t3_897pfk|dwq79ih|  1522760848|    1525907694|  False|    0|[kinda, what, hap...|[kinda what happe...|(262144,[0,6,11,2...|(262144,[0,6,11,2...|\n|      12|This sounds like ...|   -6|t3_92lntd|e36lekj|  1532781451|    1536789657|   True|    1|[this, sound, lik...|[this sound like,...|(262144,[514,852,...|(262144,[514,852,...|\n|      13|If nothing comes ...|    2|t3_7h4fo1|dqo8bzn|  1512250097|    1514278382|  False|    0|[if, nothing, com...|[if nothing come,...|(262144,[23661,43...|(262144,[23661,43...|\n|      14|If medicine keeps...|    3|t3_6a1n9a|dhcmyqr|  1494371185|    1496395068|  False|    0|[if, medicine, ke...|[if medicine keep...|(262144,[34,402,6...|(262144,[34,402,6...|\n|      15|do you think the ...|   38|t3_6cmkb4|dhvrjpu|  1495453015|    1496726838|  False|    0|[do, you, think, ...|[do you think, yo...|(262144,[24,47,11...|(262144,[24,47,11...|\n|      16|I don\u0027t understan...|   12|t3_63kuuw|dfuzqkt|  1491398216|    1493815055|  False|    0|[i, do, not, unde...|[i do not, do not...|(262144,[0,285,19...|(262144,[0,285,19...|\n|      17|I dislike the ton...|    2|t3_68cz07|dgy714f|  1493569268|    1494504338|   True|    1|[i, dislike, the,...|[i dislike the, d...|(262144,[967,1000...|(262144,[967,1000...|\n|      18|I look forward to...|    2|t3_95391g|e3pvpie|  1533583605|    1537146813|  False|    0|[i, look, forward...|[i look forward, ...|(262144,[100,320,...|(262144,[100,320,...|\n|      19|My visible tattoo...|    2|t3_966h9i|e3y8tfx|  1533911117|    1537326805|  False|    0|[my, visible, tat...|[my visible tatto...|(262144,[15,149,1...|(262144,[15,149,1...|\n|      20|3 weeks?  Why onl...|   14|t3_90f0in|e2q1bny|  1532093248|    1536306515|   True|    1|[3, week, why, on...|[3 week why, week...|(262144,[67786,11...|(262144,[67786,11...|\n+--------+--------------------+-----+---------+-------+------------+--------------+-------+-----+--------------------+--------------------+--------------------+--------------------+\nonly showing top 20 rows\n\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1556105044620_368373304",
      "id": "20190424-112404_1308508179",
      "dateCreated": "2019-04-24 11:24:04.620",
      "dateStarted": "2019-04-24 14:39:47.136",
      "dateFinished": "2019-04-24 14:39:48.789",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%pyspark\nsplits \u003d df_tfidf.select([\u0027body_tfidf\u0027, \u0027label\u0027]).randomSplit([0.8,0.2],seed\u003d100)\ntrain \u003d splits[0].cache()\ntest \u003d splits[1].cache()",
      "user": "anonymous",
      "dateUpdated": "2019-04-24 14:40:00.025",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "jobName": "paragraph_1556107967909_1030280264",
      "id": "20190424-121247_530364756",
      "dateCreated": "2019-04-24 12:12:47.909",
      "dateStarted": "2019-04-24 14:40:00.070",
      "dateFinished": "2019-04-24 14:40:00.239",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%pyspark\nfrom pyspark.ml.classification import LogisticRegression\n\nmax_iter \u003d 10\nreg_param \u003d 0.3\nelastic_net_param \u003d 0.8\n\nlr \u003d LogisticRegression(featuresCol\u003d\u0027body_tfidf\u0027, maxIter\u003d10)\n        \nlr_model \u003d lr.fit(train)\nlr_pred \u003d lr_model.transform(test)",
      "user": "anonymous",
      "dateUpdated": "2019-04-24 15:54:38.668",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "jobName": "paragraph_1556108056948_373468350",
      "id": "20190424-121416_1680948410",
      "dateCreated": "2019-04-24 12:14:16.948",
      "dateStarted": "2019-04-24 14:40:05.915",
      "dateFinished": "2019-04-24 14:40:08.399",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%pyspark\nfrom pyspark.ml.evaluation import MulticlassClassificationEvaluator\n\nmodel_eval \u003d MulticlassClassificationEvaluator(labelCol\u003d\"label\", predictionCol\u003d\"prediction\", metricName\u003d\"accuracy\")\nlr_score \u003d model_eval.evaluate(lr_pred)\nprint(\"Score: %.4f\" % lr_score)",
      "user": "anonymous",
      "dateUpdated": "2019-04-24 14:40:11.768",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "Score: 0.6206\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1556109914197_372257927",
      "id": "20190424-124514_390313954",
      "dateCreated": "2019-04-24 12:45:14.198",
      "dateStarted": "2019-04-24 14:40:11.822",
      "dateFinished": "2019-04-24 14:40:12.924",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%pyspark\nfrom pyspark.ml import Pipeline\nfrom pyspark.ml.feature import NGram, CountVectorizer, IDF\nfrom pyspark.ml.classification import LogisticRegression\n\npipeline \u003d Pipeline(stages\u003d[\n    SpacyTokenizer(inputCol\u003d\"body\", outputCol\u003d\"body_tokenized\"), \n    NGram(inputCol\u003d\u0027body_tokenized\u0027, outputCol\u003d\u0027body_ngram\u0027, n\u003d3), \n    CountVectorizer(inputCol\u003d\u0027body_ngram\u0027, outputCol\u003d\u0027body_tf\u0027), \n    IDF(inputCol\u003d\u0027body_tf\u0027, outputCol\u003d\u0027body_tfidf\u0027),\n    LogisticRegression(featuresCol\u003d\u0027body_tfidf\u0027, maxIter\u003d10)])\n    \n\nsplits \u003d df_input.randomSplit([0.8,0.2], seed\u003d100)\ntrain \u003d splits[0].cache()\ntest \u003d splits[1].cache()",
      "user": "anonymous",
      "dateUpdated": "2019-04-24 15:54:19.353",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "jobName": "paragraph_1556110966630_1699574621",
      "id": "20190424-130246_910680063",
      "dateCreated": "2019-04-24 13:02:46.630",
      "dateStarted": "2019-04-24 15:54:19.400",
      "dateFinished": "2019-04-24 15:54:19.596",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%pyspark\npipeline_model \u003d pipeline.fit(train)",
      "user": "anonymous",
      "dateUpdated": "2019-04-24 15:54:22.008",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "jobName": "paragraph_1556117262549_-1833139638",
      "id": "20190424-144742_1374770811",
      "dateCreated": "2019-04-24 14:47:42.549",
      "dateStarted": "2019-04-24 15:54:22.071",
      "dateFinished": "2019-04-24 15:55:42.272",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%pyspark\npipeline_pred \u003d pipeline_model.transform(test)",
      "user": "anonymous",
      "dateUpdated": "2019-04-24 15:57:47.378",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+--------+--------------------+-----+---------+-------+------------+--------------+-------+-----+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+----------+\n|prev_idx|                body|score|parent_id|     id|created_date|retrieved_date|removed|label|      body_tokenized|          body_ngram|             body_tf|          body_tfidf|       rawPrediction|         probability|prediction|\n+--------+--------------------+-----+---------+-------+------------+--------------+-------+-----+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+----------+\n|       5|Well i was wantin...|    3|t3_99wi9m|e4rtew8|  1535140675|    1537893540|  False|    0|[well, i, be, wan...|[well i be, i be ...|(262144,[2050,281...|(262144,[2050,281...|[-1.6801771956811...|[0.15707200668228...|       1.0|\n|       8|Rains here just s...|    2|t3_9dzqzm|e5lmvpe|  1536388817|    1538826252|   True|    1|[rains, here, jus...|[rains here just,...|(262144,[1061,453...|(262144,[1061,453...|[1.39379371046033...|[0.80119719682442...|       0.0|\n|       9|That explains it,...|    5|t3_81yesj|dv63j9z|  1520179348|    1524803905|   True|    1|[that, explain, i...|[that explain it,...|(262144,[504,1178...|(262144,[504,1178...|[0.47017179182358...|[0.61542441640582...|       0.0|\n|      10|Hi BocceBaller42,...|    2|t3_5r1nu1|dd3pv7z|  1485793932|    1486560607|  False|    0|[hi, bocceballer4...|[hi bocceballer42...|(262144,[30,61,63...|(262144,[30,61,63...|[8.32119843849355...|[0.99975675507805...|       0.0|\n|      16|I don\u0027t understan...|   12|t3_63kuuw|dfuzqkt|  1491398216|    1493815055|  False|    0|[i, do, not, unde...|[i do not, do not...|(262144,[0,167,18...|(262144,[0,167,18...|[1.63951250676852...|[0.83746859321900...|       0.0|\n|      20|3 weeks?  Why onl...|   14|t3_90f0in|e2q1bny|  1532093248|    1536306515|   True|    1|[3, week, why, on...|[3 week why, week...|      (262144,[],[])|      (262144,[],[])|[0.49927343712794...|[0.62228857104400...|       0.0|\n|      22|New study shows 9...|   18|t3_7a2pmo|dp6rpcw|  1509542898|    1512014062|   True|    1|[new, study, show...|[new study show, ...|(262144,[760,1878...|(262144,[760,1878...|[-4.1058282714566...|[0.01620929598344...|       1.0|\n|      26|Thank goodness, t...|    2|t3_5rhzw9|dd835v5|  1486012935|    1488495268|   True|    1|[thank, goodness,...|[thank goodness t...|(262144,[15,2229,...|(262144,[15,2229,...|[0.95425867015701...|[0.72197082397532...|       0.0|\n|      27|The post title is...|   43|t3_8axsbq|dx2ce5e|  1523274548|    1526127980|  False|    0|[the, post, title...|[the post title, ...|(262144,[95,132,1...|(262144,[95,132,1...|[14.0253131076134...|[0.99999918925634...|       0.0|\n|      35|\u0027Max Planck from ...|   15|t3_80psqz|duxc8nz|  1519765498|    1520318924|  False|    0|[max, planck, fro...|[max planck from,...|(262144,[247,841,...|(262144,[247,841,...|[2.89779330842830...|[0.94773724441548...|       0.0|\n|      36|Yeah that\u0027s what ...|   -5|t3_8hj5o8|dyk75cx|  1525651444|    1527161414|   True|    1|[yeah, that, have...|[yeah that have, ...|(262144,[0,218,41...|(262144,[0,218,41...|[1.20027998367868...|[0.76857458729422...|       0.0|\n|      41|\"My Strong app ha...|    2|t3_8ivgqb|dyuwanv|  1526126637|    1527378492|  False|    0|[my, strong, app,...|[my strong app, s...|(262144,[86,309,6...|(262144,[86,309,6...|[2.13742324798880...|[0.89448766504480...|       0.0|\n|      50|How did you choos...|    2|t3_81dvbs|dv2q55a|  1520006350|    1524739051|  False|    0|[how, do, you, ch...|[how do you, do y...|(262144,[40,1021,...|(262144,[40,1021,...|[2.44818142400976...|[0.92042836011668...|       0.0|\n|      53|The thumbnail loo...|    2|t3_6qfl2m|dkxz5tl|  1501457255|    1501985168|   True|    1|[the, thumbnail, ...|[the thumbnail lo...|(262144,[116,6471...|(262144,[116,6471...|[-0.3421830781795...|[0.41527927893229...|       1.0|\n|      58|Lipstick as birth...|    2|t3_6mfd6a|dk1l9j6|  1499721082|    1501129496|   True|    1|[lipstick, a, bir...|[lipstick a birth...|(262144,[22893],[...|(262144,[22893],[...|[0.17651307368556...|[0.54401404940302...|       0.0|\n|      63|   My question is...|   -1|t3_6ll02s|djuzmjw|  1499359162|    1501007322|  False|    0|[my, question, be...|[my question be, ...|(262144,[289,1057...|(262144,[289,1057...|[3.24896978401304...|[0.96263607564559...|       0.0|\n|      73|My children will ...|    6|t3_71q0q2|dncphu2|  1506085704|    1506999701|  False|    0|[my, child, will,...|[my child will, c...|(262144,[8462,223...|(262144,[8462,223...|[4.01468326375975...|[0.98227130898572...|       0.0|\n|      75|a more simplified...|   11|t3_7454xh|dnvmhci|  1507084744|    1509286643|   True|    1|[a, much, simplif...|[a much simplify,...|(262144,[3,439,69...|(262144,[3,439,69...|[2.98754239756838...|[0.95200815030676...|       0.0|\n|      85|what if a woman d...|    0|t3_6flqpj|dijtdm0|  1496783902|    1499122474|  False|    0|[what, if, a, wom...|[what if a, if a ...|(262144,[18,376,1...|(262144,[18,376,1...|[2.08998682317081...|[0.88992613487344...|       0.0|\n|      88|Thinking back to ...|    2|t3_6xl6ch|dmgt0bu|  1504358856|    1506427511|   True|    1|[thinking, back, ...|[thinking back to...|(262144,[656,8403...|(262144,[656,8403...|[-0.8706467895190...|[0.29511973638163...|       1.0|\n+--------+--------------------+-----+---------+-------+------------+--------------+-------+-----+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+----------+\nonly showing top 20 rows\n\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1556117278624_402507066",
      "id": "20190424-144758_1037030750",
      "dateCreated": "2019-04-24 14:47:58.624",
      "dateStarted": "2019-04-24 15:55:45.135",
      "dateFinished": "2019-04-24 15:56:23.407",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%pyspark\npipeline_pred.select([\"body\", \"probability\", \"prediction\"]).show()",
      "user": "anonymous",
      "dateUpdated": "2019-04-24 15:58:10.504",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+--------------------+--------------------+----------+\n|                body|         probability|prediction|\n+--------------------+--------------------+----------+\n|Well i was wantin...|[0.15707200668228...|       1.0|\n|Rains here just s...|[0.80119719682442...|       0.0|\n|That explains it,...|[0.61542441640582...|       0.0|\n|Hi BocceBaller42,...|[0.99975675507805...|       0.0|\n|I don\u0027t understan...|[0.83746859321900...|       0.0|\n|3 weeks?  Why onl...|[0.62228857104400...|       0.0|\n|New study shows 9...|[0.01620929598344...|       1.0|\n|Thank goodness, t...|[0.72197082397532...|       0.0|\n|The post title is...|[0.99999918925634...|       0.0|\n|\u0027Max Planck from ...|[0.94773724441548...|       0.0|\n|Yeah that\u0027s what ...|[0.76857458729422...|       0.0|\n|\"My Strong app ha...|[0.89448766504480...|       0.0|\n|How did you choos...|[0.92042836011668...|       0.0|\n|The thumbnail loo...|[0.41527927893229...|       1.0|\n|Lipstick as birth...|[0.54401404940302...|       0.0|\n|   My question is...|[0.96263607564559...|       0.0|\n|My children will ...|[0.98227130898572...|       0.0|\n|a more simplified...|[0.95200815030676...|       0.0|\n|what if a woman d...|[0.88992613487344...|       0.0|\n|Thinking back to ...|[0.29511973638163...|       1.0|\n+--------------------+--------------------+----------+\nonly showing top 20 rows\n\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1556121460325_1024954747",
      "id": "20190424-155740_1487288527",
      "dateCreated": "2019-04-24 15:57:40.325",
      "dateStarted": "2019-04-24 15:58:10.557",
      "dateFinished": "2019-04-24 15:58:22.961",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%pyspark\nfrom pyspark.ml.evaluation import MulticlassClassificationEvaluator\n\npipeline_eval \u003d MulticlassClassificationEvaluator(labelCol\u003d\"label\", predictionCol\u003d\"prediction\", metricName\u003d\"accuracy\")\npipeline_score \u003d pipeline_eval.evaluate(pipeline_pred)\nprint(\"Score: %.4f\" % pipeline_score)",
      "user": "anonymous",
      "dateUpdated": "2019-04-24 15:58:50.025",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "Score: 0.6036\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1556117338993_-1207294821",
      "id": "20190424-144858_1610760957",
      "dateCreated": "2019-04-24 14:48:58.993",
      "dateStarted": "2019-04-24 15:58:50.078",
      "dateFinished": "2019-04-24 15:59:03.394",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%pyspark\npipeline_model.save(\"/machinelearning/spark_pipeline.model\")",
      "user": "anonymous",
      "dateUpdated": "2019-04-24 15:59:52.782",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "jobName": "paragraph_1556117464354_-618245016",
      "id": "20190424-145104_1024882918",
      "dateCreated": "2019-04-24 14:51:04.354",
      "dateStarted": "2019-04-24 15:59:52.842",
      "dateFinished": "2019-04-24 15:59:57.161",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%pyspark\n",
      "user": "anonymous",
      "dateUpdated": "2019-04-24 14:53:23.022",
      "config": {},
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1556117603021_-2003078605",
      "id": "20190424-145323_279644109",
      "dateCreated": "2019-04-24 14:53:23.021",
      "status": "READY",
      "progressUpdateIntervalMs": 500
    }
  ],
  "name": "Model Development",
  "id": "2EBFMN6U9",
  "noteParams": {},
  "noteForms": {},
  "angularObjects": {
    "sh:shared_process": [],
    "spark:shared_process": []
  },
  "config": {
    "isZeppelinNotebookCronEnable": false
  },
  "info": {}
}